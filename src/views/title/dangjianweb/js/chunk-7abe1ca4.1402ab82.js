(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7abe1ca4"],{"2f3a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ToolBar",[a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.showEditDialog=!0}}},[t._v("添加商品")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.exportTable}},[t._v("本地导出表格")])],1),a("div",[a("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"请输入商品名",size:"small",clearable:""},model:{value:t.searchParams.title,callback:function(e){t.$set(t.searchParams,"title",e)},expression:"searchParams.title"}}),a("el-select",{staticStyle:{width:"140px"},attrs:{clearable:"",placeholder:"请选择商品类型",size:"small"},model:{value:t.searchParams.type,callback:function(e){t.$set(t.searchParams,"type",e)},expression:"searchParams.type"}},t._l(t.goodsTypeData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.typename,value:t.id}})})),1),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.refresh()}}},[t._v("查询")]),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){return t.clearSearchParams()}}},[t._v("重置")])],1)]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"商品名"}}),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),a("el-table-column",{attrs:{prop:"",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.serverImageUrl+e.row.imgpath}})]}}])}),a("el-table-column",{attrs:{prop:"",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.state?a("div",[t._v("已下架")]):t._e(),2==e.row.state?a("div",[t._v("已上架")]):t._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.editItem(e.row.id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return t.updateState(e.row.id,0)}}},[t._v("删除")]),1==e.row.state?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){return t.updateState(e.row.id,2)}}},[t._v("上架")]):t._e(),2==e.row.state?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){return t.updateState(e.row.id,1)}}},[t._v("下架")]):t._e()],1)}}])})],1),a("el-pagination",{attrs:{background:"","page-size":t.pageSize,layout:"prev, pager, next",total:t.total},on:{"current-change":t.changePage}}),a("Edit",{attrs:{showEditDialog:t.showEditDialog},on:{close:function(e){t.showEditDialog=!1},success:function(e){return t.refresh()}}})],1)},o=[],i=a("b4fa"),r=a("b775");function n(t){return Object(r["a"])({url:"/goodsType/list",method:"get",params:t})}var l=a("588a"),c=a("cf45"),u=a("6f5e"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{width:t.dialogWidth,title:t.title,visible:t.showEditDialog,"show-close":!1,"close-on-click-modal":!1},on:{opened:t.openDialog,"update:visible":function(e){t.showEditDialog=e}}},[a("el-form",{ref:"editForms",staticClass:"edit-forms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":t.labelWidth}},[a("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[a("el-input",{model:{value:t.forms.name,callback:function(e){t.$set(t.forms,"name",e)},expression:"forms.name"}})],1),a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-input",{attrs:{placeholder:"最多2位小数"},model:{value:t.forms.price,callback:function(e){t.$set(t.forms,"price",e)},expression:"forms.price"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"goodsdesc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.forms.goodsdesc,callback:function(e){t.$set(t.forms,"goodsdesc",e)},expression:"forms.goodsdesc"}})],1),a("el-form-item",{attrs:{label:"商品类型",prop:"typeid"}},[a("el-select",{attrs:{placeholder:"请选择商品类型"},model:{value:t.forms.typeid,callback:function(e){t.$set(t.forms,"typeid",e)},expression:"forms.typeid"}},t._l(t.goodsTypeData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.typename,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"图片",prop:"imgpath"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{name:"picture",action:t.serverApiUrl+"/upload/uploadGoodsImg","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.forms.url?a("img",{staticClass:"avatar",attrs:{src:t.forms.url}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.$emit("close")}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确认")])],1)],1)},p=[],f=(a("e18c"),a("96db"),a("af86"),a("f1a9"),a("c451")),m=a("b48b"),h={props:{title:{type:String,default:"编辑"},dialogWidth:{type:String,default:"700px"},labelWidth:{type:String,default:"120px"},showEditDialog:m["a"]},data:function(){return{forms:{name:"",goodsdesc:"",price:"",url:"",typeid:"",imgpath:""},rules:Object(f["a"])({},Object(m["b"])(["name"],m["d"]),{price:[m["d"],m["c"]],typeid:m["a"]}),serverApiUrl:u["a"],goodsTypeData:[]}},created:function(){this.initData()},methods:{initData:function(){var t=this;n().then((function(e){t.goodsTypeData=e})).catch((function(){}))},submit:function(){var t=this;this.$refs.editForms.validate((function(e){if(!e)return t.$message({message:"请按照提示正确填写内容！",type:"warning"}),!1;t.$message({message:"字段验证通过，提交请求，成功后刷新分页！",type:"success"}),Object(i["c"])(t.forms).then((function(e){t.$message({message:e.msg,type:"success"}),t.$emit("success"),t.$parent.showEditDialog=!1})).catch((function(){}))}))},openDialog:function(){var t=this;console.log(this.$parent.id),null!=this.$parent.id?Object(i["a"])({id:this.$parent.id}).then((function(e){t.FillerFormField(t.$parent.id,e),t.forms.url=t.$parent.serverImageUrl+e.imgpath,t.$parent.id=null})).catch((function(){})):(Object(c["e"])(this.forms),this.$set(this.forms,"id",null),this.$refs.editForms.resetFields())},FillerFormField:function(t,e){this.$set(this.forms,"id",t),Object(c["a"])(this.forms,e)},handleAvatarSuccess:function(t,e){console.log(t),console.log(e),this.$message({type:"info",message:"图片上传成功",duration:6e3}),"success"==e.response.status&&(this.forms.imgpath=e.response.msg,this.forms.url=URL.createObjectURL(e.raw))},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a="image/gif"===t.type,s="image/png"===t.type,o="image/bmp"===t.type,i=t.size/1024/1024<2;return e||a||s||o||this.$message.error("上传头像图片只能是 JPG 格式!"),i||this.$message.error("上传头像图片大小不能超过 2MB!"),(e||o||a||s)&&i}}},g=h,b=(a("a329"),a("e90a")),y=Object(b["a"])(g,d,p,!1,null,null,null),v=y.exports,w={data:function(){return{serverImageUrl:u["a"]+"/upload/goods/",pageSize:5,total:0,pageNo:1,searchParams:{title:"",type:""},showEditDialog:!1,tableData:[],goodsTypeData:[],id:null,stateValue:1}},created:function(){this.initData()},methods:{changePage:function(t){this.pageNo=t,this.initData()},initData:function(){var t=this;Object(i["b"])({pageNo:this.pageNo,pageSize:this.pageSize,name:this.searchParams.title,typeid:this.searchParams.type}).then((function(e){t.tableData=e.list,t.total=e.count})).catch((function(){})),n().then((function(e){t.goodsTypeData=e})).catch((function(){}))},editItem:function(t){this.id=t,this.showEditDialog=!0},exportTable:function(){Object(l["a"])([{title:"文章标题",field:"title"},{title:"浏览量",field:"visit_count"}],this.tableData,"文章列表")},refresh:function(){this.initData()},returnData:function(t){this.tableData=t.list},clearSearchParams:function(){Object(c["e"])(this.searchParams),this.refresh()},updateState:function(t,e){var a=this;0==e?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.updateStateApi(t,e)})).catch((function(){})):this.updateStateApi(t,e)},updateStateApi:function(t,e){var a=this;console.log(t,e),Object(i["d"])({id:t,state:e}).then((function(t){a.$message({type:"success",message:t.msg}),a.refresh()})).catch((function(){}))}},components:{Edit:v}},D=w,$=Object(b["a"])(D,s,o,!1,null,null,null);e["default"]=$.exports},a329:function(t,e,a){"use strict";var s=a("f34c"),o=a.n(s);o.a},b4fa:function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return n}));var s=a("b775");function o(t){return Object(s["a"])({url:"/goods/getGoodsList",method:"post",data:t})}function i(t){return console.log("goods的参数"+t),Object(s["a"])({url:"/goods/saveGoods",method:"post",data:t})}function r(t){return Object(s["a"])({url:"/goods/getGoodsById",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/goods/updateState",method:"post",data:t})}},f34c:function(t,e,a){}}]);
//# sourceMappingURL=chunk-7abe1ca4.1402ab82.js.map